{% extends 'chops/base.html' %}
{% load static %}
{% block content %}



<div class="product-detail">
    <div class="row">
        <div class="pro-img-container">
            <img class="pro-img" src="{{ product.imageURL }}" alt="{{ product.name }}" />
        </div>
        <div class="secure-detail">
    

       
        <div class="parallax-content section-xl text-md-left">
            <h4 class="product-title">{{product.name}}</h4>
                <div class="product-rating"><span class="mdi mdi-star"></span><span class="mdi mdi-star"></span><span class="mdi mdi-star"></span><span class="mdi mdi-star"></span><span class="mdi mdi-star text-gray-13"></span>
                </div>
                <div class="product-price-wrap">
                <div class="product-price">â‚¦{{product.price|floatformat:2}}</div>
                </div>
            
                <p>Description: {{ product.description }}</p>

                <!-- Additional product details -->
                
                
                <div class="d-flex align-items-center mb-4 pt-2">
                    <div class="input-group quantity mr-3" style="width: 130px;">
                        <div class="input-group-btn">
                                            <button class="btn btn-primary btn-minus"  >
                                <i class="fa fa-minus"></i>
                            </button>
                        </div>
                        <input type="text" id="quantityInput_{{ product.id }}" name="quantity" data-product="{{ product.id }}" data-action="add" class="form-control bg-secondary text-center" value="1">
                        <div class="input-group-btn">
                            <button  class="btn btn-primary btn-plus ">
                                <i class="fa fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <button data-product={{product.id}} data-action="add"  class="btn btn-primary px-3 update-cart"><i class="fa fa-shopping-cart mr-1"></i> Add To Cart</button>
                                </div>
            </div>
            
       
       
        </div>
    

        

    </div>



    <a href="{% url 'product_list' %}">Back to Product List</a>
</div>
<form method="post" id="ratingForm" data-product-id="{{ product.id }}">
    {% csrf_token %}
    <label for="rating">Rate this product:</label>
    <select name="rating" id="rating">
        <option value="1">1 star</option>
        <option value="2">2 stars</option>
        <option value="3">3 stars</option>
        <option value="4">4 stars</option>
        <option value="5">5 stars</option>
    </select>
    <button type="submit">Submit Rating</button>
</form>

<!-- Display Ratings -->
<div class="all-ratings">
    <h3>All Ratings</h3>
    <ul>
        {% for review in product.review_set.all %}
            <li>{{ review.customer.username }} rated {{ review.rating }} stars on {{ review.date_added }}</li>
        {% endfor %}
    </ul>
    <p>Average Rating: {{ product.average_rating }}</p>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const ratingForm = document.getElementById('ratingForm');

        if (ratingForm) {
            ratingForm.addEventListener('submit', function (event) {
                event.preventDefault();
                
                const productId = this.dataset.productId;
                const rating = document.getElementById('rating').value;

                // You can use AJAX to send the rating to the server
                // For simplicity, I'll just reload the page to demonstrate
                // Replace this with your AJAX logic
                location.reload();
            });
        }
    });
</script>




{% endblock %}

